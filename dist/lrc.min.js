/*
* Lrc.js v1.0.0
* (c) 2018 Ryan Gao
* Released under the MIT License.
*/
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.LRC=e()}(this,function(){"use strict";var t=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var u,f=t[Symbol.iterator]();!(i=(u=f.next()).done)&&(n.push(u.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{!i&&f.return&&f.return()}finally{if(r)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),e=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();var n=["ti","al","ar","au","by","offset","length","re","ve"],i=/^\[[^:]+:[^\]]*\]/,r=/\[(\d+):(\d+)(?:.(\d+))?\]/,o=/\[(\d+):(\d+)(?:.(\d+))?\]/g,u=/\[([a-z]+):([^\]]*)\]/;return function(){function f(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),"string"==typeof t)return f.parse(t);this.clone(t)}return e(f,[{key:"clone",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n.forEach(function(n){t[n]=e[n]||""}),this.offset=e.offset||0,this.lines=Array.isArray(e.lines)?e.lines.map(function(t){return{time:t.time,text:t.text}}):[],this}},{key:"stringify",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,i=n.filter(function(e){return!!t[e]}).map(function(e){return"offset"===e?"["+e+":"+(t[e]>0?"+":"-")+Math.abs(t[e])+"]":"["+e+":"+t[e]+"]"}).join("\n");return i+="\n",(i+=this.lines.map(function(t){var n=Math.floor(t.time/60),i=Math.floor(t.time%60),r=t.time-Math.floor(t.time);for(n=n<10?"0"+n:""+n,i=i<10?"0"+i:""+i,r=Math.round(r*Math.pow(10,e))+"";r.length<e;)r="0"+r;return"["+n+":"+i+"."+r+"]"+t.text}).join("\n")).trim()}},{key:"toJSON",value:function(){var t=this,e={};return n.forEach(function(n){e[n]=t[n]}),e.lines=this.lines.map(function(t){return{time:t.time,text:t.text}}),e}},{key:"findIndex",value:function(t){for(var e=-1,n=0;n<this.lines.length;n++)if(this.lines[n].time>t){e=n;break}return e<0?this.lines.length-1:e-1}},{key:"previousLine",value:function(t){var e=this.findIndex(t);return e<=0?null:{idx:e-1,time:this.lines[e-1].time,text:this.lines[e-1].text}}},{key:"currentLine",value:function(t){var e=this.findIndex(t);return e<0?null:{idx:e,time:this.lines[e].time,text:this.lines[e].text}}},{key:"nextLine",value:function(t){var e=this.findIndex(t);return e<this.lines.length-1?{idx:e+1,time:this.lines[e+1].time,text:this.lines[e+1].text}:null}}],[{key:"parse",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").trim().split(/\n/).map(function(t){return t.trim()}).filter(function(t){return i.test(t)}).reduce(function(e,i){if(o.test(i)){var f=i.replace(o,"").trim();i.match(o).forEach(function(n){var i=n.match(r),o=t(i,4),u=o[1],a=o[2],l=o[3],s=60*u+1*a+(l=l?l.length>2?1*l:10*l:0)/1e3;e.lines.push({time:s,text:f})})}else if(u.test(i)){var a=i.match(u),l=t(a,3),s=l[1],c=l[2];if(s=s.trim(),c=c.trim(),n.indexOf(s)>-1)if("offset"!==s)e[s]=c||"";else{var h=1*c;e[s]=isNaN(h)?0:h}}return e},{al:"",ar:"",au:"",ti:"",by:"",offset:0,length:"",re:"",ve:"",lines:[]});return e.lines.sort(function(t,e){return t.time-e.time}),new f(e)}}]),f}()});
